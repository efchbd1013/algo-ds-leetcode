<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CodeMaster Pro - LeetCode Solutions Platform</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #6366f1;
        --primary-dark: #4f46e5;
        --secondary: #ec4899;
        --accent: #14b8a6;
        --dark: #0f172a;
        --dark-light: #1e293b;
        --gray: #64748b;
        --light: #f8fafc;
        --success: #10b981;
        --warning: #f59e0b;
        --error: #ef4444;
        --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
        --gradient-dark: linear-gradient(
          135deg,
          var(--dark),
          var(--dark-light)
        );
        --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.15);
      }

      body {
        font-family: "Inter", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--gradient-dark);
        color: white;
        min-height: 100vh;
        overflow-x: hidden;
      }

      .floating-shapes {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .shape {
        position: absolute;
        background: rgba(99, 102, 241, 0.1);
        border-radius: 50%;
        animation: float 20s infinite linear;
      }

      .shape:nth-child(1) {
        width: 80px;
        height: 80px;
        top: 20%;
        left: 10%;
        animation-delay: 0s;
      }
      .shape:nth-child(2) {
        width: 120px;
        height: 120px;
        top: 60%;
        left: 80%;
        animation-delay: -5s;
      }
      .shape:nth-child(3) {
        width: 60px;
        height: 60px;
        top: 80%;
        left: 20%;
        animation-delay: -10s;
      }
      .shape:nth-child(4) {
        width: 100px;
        height: 100px;
        top: 30%;
        left: 70%;
        animation-delay: -15s;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        33% {
          transform: translateY(-30px) rotate(120deg);
        }
        66% {
          transform: translateY(20px) rotate(240deg);
        }
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
      }

      header {
        padding: 2rem 0;
        text-align: center;
        position: relative;
      }

      .logo {
        font-size: 3rem;
        font-weight: 900;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
        text-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
      }

      .subtitle {
        font-size: 1.2rem;
        color: var(--gray);
        margin-bottom: 2rem;
      }

      .stats-bar {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-bottom: 3rem;
        flex-wrap: wrap;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 1rem 2rem;
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
        transition: all 0.3s ease;
      }

      .stat-item:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: var(--accent);
      }

      .stat-label {
        font-size: 0.9rem;
        color: var(--gray);
      }

      .controls-section {
        margin-bottom: 3rem;
      }

      .search-container {
        position: relative;
        max-width: 600px;
        margin: 0 auto 2rem;
      }

      #searchInput {
        width: 100%;
        padding: 1rem 1rem 1rem 3rem;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 25px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        color: white;
        font-size: 1.1rem;
        transition: all 0.3s ease;
      }

      #searchInput:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
      }

      #searchInput::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray);
        font-size: 1.2rem;
      }

      .filters-row {
        display: flex;
        justify-content: center;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 2rem;
      }

      .filter-btn {
        padding: 0.8rem 1.5rem;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        font-weight: 500;
      }

      .filter-btn:hover {
        border-color: var(--primary);
        background: rgba(99, 102, 241, 0.2);
        transform: translateY(-2px);
      }

      .filter-btn.active {
        background: var(--gradient);
        border-color: var(--primary);
        box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
      }

      .view-toggle {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
      }

      .view-btn {
        padding: 0.8rem 1.2rem;
        border: 2px solid rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.1);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
      }

      .view-btn:first-child {
        border-radius: 15px 0 0 15px;
      }

      .view-btn:last-child {
        border-radius: 0 15px 15px 0;
      }

      .view-btn.active {
        background: var(--gradient);
        border-color: var(--primary);
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .breadcrumb-item {
        color: var(--gray);
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .breadcrumb-item:hover {
        color: var(--primary);
      }

      .breadcrumb-separator {
        color: var(--gray);
      }

      #backBtn {
        background: var(--gradient);
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 15px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: var(--shadow);
        margin-bottom: 2rem;
      }

      #backBtn:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      #pathTitle {
        font-size: 2rem;
        margin-bottom: 2rem;
        text-align: center;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      #container {
        display: grid;
        gap: 1.5rem;
        margin-bottom: 3rem;
      }

      .grid-view {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      }

      .list-view {
        grid-template-columns: 1fr;
        max-width: 800px;
        margin: 0 auto;
      }

      .card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 2rem;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        transition: left 0.5s;
      }

      .card:hover::before {
        left: 100%;
      }

      .card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .card-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: white;
        margin-bottom: 0.5rem;
      }

      .card-meta {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        color: var(--gray);
      }

      .card-description {
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.6;
        margin-bottom: 1rem;
      }

      .card-tags {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .tag {
        background: rgba(99, 102, 241, 0.2);
        color: var(--primary);
        padding: 0.2rem 0.6rem;
        border-radius: 8px;
        font-size: 0.8rem;
        border: 1px solid rgba(99, 102, 241, 0.3);
      }

      .list-card {
        display: flex;
        align-items: center;
        gap: 2rem;
        padding: 1.5rem;
      }

      .list-card .card-content {
        flex: 1;
      }

      .list-card {
        flex-shrink: 0;
      }

      #codeViewer {
        background: var(--dark);
        border-radius: 20px;
        padding: 2rem;
        margin-top: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
      }

      .code-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .code-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
      }

      .code-actions {
        display: flex;
        gap: 1rem;
      }

      .action-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .action-btn:hover {
        background: var(--primary);
        border-color: var(--primary);
      }

      pre {
        background: var(--dark-light) !important;
        border-radius: 15px;
        padding: 2rem;
        overflow-x: auto;
        line-height: 1.6;
        font-size: 0.95rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 200px;
      }

      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-left: 4px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .no-results {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--gray);
      }

      .no-results-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .slide-in {
        animation: slideIn 0.3s ease-out;
      }

      @keyframes slideIn {
        from {
          transform: translateX(-20px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 0 15px;
        }

        .logo {
          font-size: 2rem;
        }

        .stats-bar {
          gap: 1rem;
        }

        .stat-item {
          padding: 0.8rem 1.5rem;
        }

        .filters-row {
          gap: 0.5rem;
        }

        .filter-btn {
          padding: 0.6rem 1rem;
          font-size: 0.8rem;
        }

        .card {
          padding: 1.5rem;
        }

        .list-card {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .code-header {
          flex-direction: column;
          gap: 1rem;
          align-items: flex-start;
        }

        pre {
          padding: 1rem;
          font-size: 0.85rem;
        }
      }

      .tooltip {
        position: relative;
      }

      .tooltip::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: var(--dark);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-size: 0.8rem;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
        z-index: 1000;
      }

      .tooltip:hover::after {
        opacity: 1;
      }

      .favorite-btn {
        background: none;
        border: none;
        color: var(--gray);
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .favorite-btn:hover,
      .favorite-btn.favorited {
        color: var(--secondary);
        transform: scale(1.2);
      }
    </style>
  </head>
  <body>
    <div class="floating-shapes">
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
    </div>

    <div class="container">
      <header>
        <div class="logo">CodeMaster Pro</div>
        <div class="subtitle">
          Advanced LeetCode Solutions Platform by efrat-dev
        </div>

        <div class="stats-bar" id="statsBar"></div>
      </header>

      <div class="controls-section">
        <div class="search-container">
          <div class="search-icon">🔍</div>
          <input
            type="text"
            id="searchInput"
            placeholder="Search solutions, algorithms, data structures..."
          />
        </div>

        <div class="filters-row">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="favorites">
            ★ Favorites
          </button>
        </div>

        <div class="view-toggle">
          <button class="view-btn active" data-view="grid">⊞ Grid</button>
          <button class="view-btn" data-view="list">☰ List</button>
        </div>
      </div>

      <div class="breadcrumb" id="breadcrumb"></div>

      <button id="backBtn" style="display: none">← Back</button>

      <h2 id="pathTitle">Explore Solutions</h2>

      <div id="container" class="grid-view"></div>

      <div id="codeViewer"></div>
    </div>

    <script>
      // Enhanced TypeScript-like JavaScript implementation
      class LeetCodePlatform {
        constructor() {
          this.owner = "efrat-dev";
          this.repo = "algo-ds-leetcode";
          this.branch = "main";
          this.baseUrl = `https://raw.githubusercontent.com/${this.owner}/${this.repo}/${this.branch}/`;

          this.fullTree = {};
          this.allPaths = [];
          this.filteredPaths = [];
          this.history = [];
          this.favorites = new Set(
            JSON.parse(localStorage.getItem("favorites") || "[]")
          );
          this.currentView = "grid";
          this.currentFilter = "all";
          this.searchQuery = "";
          this.problemData = new Map();

          this.initializeElements();
          this.setupEventListeners();
          this.loadData();
        }

        initializeElements() {
          this.elements = {
            searchInput: document.getElementById("searchInput"),
            container: document.getElementById("container"),
            codeViewer: document.getElementById("codeViewer"),
            pathTitle: document.getElementById("pathTitle"),
            backBtn: document.getElementById("backBtn"),
            breadcrumb: document.getElementById("breadcrumb"),
            statsBar: document.getElementById("statsBar"),
          };
        }

        setupEventListeners() {
          // Search functionality
          this.elements.searchInput.addEventListener("input", (e) => {
            this.searchQuery = e.target.value.trim().toLowerCase();
            this.debounceSearch();
          });

          // Filter buttons
          document.querySelectorAll(".filter-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              document
                .querySelectorAll(".filter-btn")
                .forEach((b) => b.classList.remove("active"));
              e.target.classList.add("active");
              this.currentFilter = e.target.dataset.filter;
              this.applyFilters();
            });
          });

          // View toggle
          document.querySelectorAll(".view-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              document
                .querySelectorAll(".view-btn")
                .forEach((b) => b.classList.remove("active"));
              e.target.classList.add("active");
              this.currentView = e.target.dataset.view;
              this.elements.container.className =
                this.currentView === "grid" ? "grid-view" : "list-view";
              this.renderCurrentLevel();
            });
          });

          // Back button
          this.elements.backBtn.addEventListener("click", () => {
            this.navigateBack();
          });

          // Keyboard shortcuts
          document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") {
              this.navigateBack();
            } else if (e.key === "/" && !e.target.matches("input")) {
              e.preventDefault();
              this.elements.searchInput.focus();
            }
          });
        }

        debounceSearch() {
          clearTimeout(this.searchTimeout);
          this.searchTimeout = setTimeout(() => {
            this.applyFilters();
          }, 300);
        }

        async loadData() {
          try {
            this.showLoading();
            const response = await fetch(
              `https://api.github.com/repos/${this.owner}/${this.repo}/git/trees/${this.branch}?recursive=1`
            );
            const data = await response.json();

            const treeItems = data.tree.filter(
              (item) => item.type === "blob" || item.type === "tree"
            );
            this.allPaths = treeItems.map((item) => item.path);

            const filesOnly = treeItems.filter(
              (item) => item.type === "blob" && item.path.endsWith(".cs")
            );

            this.fullTree = this.buildTree(filesOnly.map((f) => f.path));
            this.generateProblemData();
            this.updateStats();
            this.applyFilters();
          } catch (error) {
            console.error("Error loading data:", error);
            this.showError("Failed to load solutions. Please try again.");
          }
        }

        buildTree(paths) {
          const root = {};
          for (const path of paths) {
            const parts = path.split("/");
            let curr = root;
            for (let i = 0; i < parts.length; i++) {
              const part = parts[i];
              if (!curr[part]) {
                curr[part] = i === parts.length - 1 ? path : {};
              }
              curr = curr[part];
            }
          }
          return root;
        }

        generateProblemData() {
          this.allPaths.forEach((path) => {
            if (path.endsWith(".cs")) {
              const name = path.split("/").pop().replace(".cs", "");
              const problemNum = this.extractProblemNumber(name);

              this.problemData.set(path, {
                name: this.formatProblemName(name),
                description: this.generateDescription(name),
              });
            }
          });
        }

        extractProblemNumber(name) {
          const match = name.match(/(\d+)/);
          return match ? parseInt(match[1]) : 0;
        }

        formatProblemName(name) {
          return name
            .replace(/([A-Z])/g, " $1")
            .replace(/^\s+/, "")
            .replace(/\d+\s*/, "")
            .trim();
        }

        generateDescription(name) {
          const descriptions = [
            "A challenging algorithmic problem that tests your understanding of data structures.",
            "An elegant solution showcasing advanced programming techniques.",
            "A classic problem from technical interviews at top tech companies.",
            "An optimized approach to a common computational challenge.",
            "A fundamental algorithm every programmer should master.",
          ];
          return descriptions[Math.floor(Math.random() * descriptions.length)];
        }

        updateStats() {
          const totalFiles = this.allPaths.filter((p) =>
            p.endsWith(".cs")
          ).length;
        }

        animateNumber(element, start, end, duration) {
          const startTime = performance.now();
          const animate = (currentTime) => {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const current = Math.floor(start + (end - start) * progress);
            element.textContent = current;

            if (progress < 1) {
              requestAnimationFrame(animate);
            }
          };
          requestAnimationFrame(animate);
        }

        applyFilters() {
          let paths = [...this.allPaths];

          // Apply search filter
          if (this.searchQuery) {
            paths = paths.filter((path) => {
              const name = path.split("/").pop();
              return name.toLowerCase().includes(this.searchQuery);
            });
          }

          if (this.currentFilter !== "all") {
            if (this.currentFilter === "favorites") {
              paths = paths.filter((path) => this.favorites.has(path));
            }
          }

          this.filteredPaths = paths;
          this.renderResults(
            paths,
            this.searchQuery ? "Search Results" : "Explore Solutions"
          );
        }

        renderResults(paths, title) {
          this.elements.pathTitle.textContent = title;
          this.elements.container.innerHTML = "";
          this.elements.codeViewer.innerHTML = "";
          this.updateBreadcrumb([title]);
          this.elements.backBtn.style.display = this.history.length
            ? "inline-block"
            : "none";

          if (paths.length === 0) {
            this.showNoResults();
            return;
          }

          paths.forEach((path, index) => {
            const card = this.createCard(path, index);
            this.elements.container.appendChild(card);
          });
        }

        createCard(path, index) {
          const parts = path.split("/");
          const fileName = parts[parts.length - 1];
          const isFile = fileName.endsWith(".cs");
          const displayName = fileName.replace(/\.cs$/, "");
          const data = this.problemData.get(path);

          const card = document.createElement("div");
          card.className = `card fade-in ${
            this.currentView === "list" ? "list-card" : ""
          }`;
          card.style.animationDelay = `${index * 0.1}s`;

          if (isFile && data) {
            card.innerHTML = this.createFileCardContent(
              displayName,
              data,
              path
            );
          } else {
            card.innerHTML = this.createFolderCardContent(displayName);
          }

          card.onclick = () => {
            if (isFile) {
              this.loadFile(path);
            } else {
              this.navigateToFolder(path, displayName);
            }
          };

          return card;
        }

        createFileCardContent(name, data, path) {
          return `
                    <div class="card-header">
                        <div>
                            <div class="card-title">${name}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <button class="favorite-btn ${
                              this.favorites.has(path) ? "favorited" : ""
                            }" 
                                    onclick="event.stopPropagation(); platform.toggleFavorite('${path}')"
                                    data-tooltip="Add to favorites">
                                ♥
                            </button>
                        </div>
                    </div>
                    <div class="card-description">${data.description}</div>
                `;
        }

        createFolderCardContent(name) {
          return `
                    <div class="card-header">
                        <div class="card-title">📁 ${name}</div>
                        <div class="tag">Folder</div>
                    </div>
                    <div class="card-description">
                        Explore solutions in this category
                    </div>
                `;
        }

        toggleFavorite(path) {
          if (this.favorites.has(path)) {
            this.favorites.delete(path);
          } else {
            this.favorites.add(path);
          }
          localStorage.setItem(
            "favorites",
            JSON.stringify([...this.favorites])
          );

          // Update the UI
          if (this.currentFilter === "favorites") {
            this.applyFilters();
          } else {
            this.updateFavoriteButtons();
          }
        }

        updateFavoriteButtons() {
          document.querySelectorAll(".favorite-btn").forEach((btn) => {
            const path = btn.onclick.toString().match(/'([^']+)'/)[1];
            btn.classList.toggle("favorited", this.favorites.has(path));
          });
        }

        navigateToFolder(path, name) {
          const subtree = this.getSubTree(this.fullTree, path.split("/"));
          if (subtree) {
            this.history.push({
              level: this.filteredPaths,
              title: this.elements.pathTitle.textContent,
              filter: this.currentFilter,
              search: this.searchQuery,
            });
            this.renderLevel(subtree, name);
          }
        }

        renderLevel(level, title) {
          this.elements.pathTitle.textContent = title;
          this.elements.container.innerHTML = "";
          this.elements.codeViewer.innerHTML = "";
          this.updateBreadcrumb(this.getBreadcrumbPath(title));
          this.elements.backBtn.style.display = this.history.length
            ? "inline-block"
            : "none";

          const items = Object.keys(level);
          items.forEach((key, index) => {
            const card = document.createElement("div");
            card.className = `card fade-in ${
              this.currentView === "list" ? "list-card" : ""
            }`;
            card.style.animationDelay = `${index * 0.1}s`;

            const isFile = typeof level[key] === "string";
            const displayName = key.replace(/\.cs$/, "");

            if (isFile) {
              const data = this.problemData.get(level[key]);
              if (data) {
                card.innerHTML = this.createFileCardContent(
                  displayName,
                  data,
                  level[key]
                );
              }
            } else {
              card.innerHTML = this.createFolderCardContent(displayName);
            }

            card.onclick = () => {
              if (isFile) {
                this.loadFile(level[key]);
              } else {
                this.history.push({ level, title });
                this.renderLevel(level[key], key);
              }
            };

            this.elements.container.appendChild(card);
          });
        }

        renderCurrentLevel() {
          // Re-render current view with new display settings
          this.applyFilters();
        }

        getSubTree(tree, parts) {
          let curr = tree;
          for (const part of parts) {
            if (curr[part] && typeof curr[part] === "object") {
              curr = curr[part];
            } else {
              return null;
            }
          }
          return curr;
        }

        getBreadcrumbPath(title) {
          const path = ["Home"];
          if (title !== "Explore Solutions") {
            path.push(title);
          }
          return path;
        }

        updateBreadcrumb(path) {
          this.elements.breadcrumb.innerHTML = path
            .map((item, index) => {
              const isLast = index === path.length - 1;
              return `
                        <span class="breadcrumb-item ${
                          isLast ? "current" : ""
                        }" 
                              ${
                                !isLast
                                  ? `onclick="platform.navigateToBreadcrumb(${index})"`
                                  : ""
                              }>
                            ${item}
                        </span>
                        ${
                          !isLast
                            ? '<span class="breadcrumb-separator">›</span>'
                            : ""
                        }
                    `;
            })
            .join("");
        }

        navigateToBreadcrumb(index) {
          if (index === 0) {
            this.history = [];
            this.applyFilters();
          }
        }

        async loadFile(path) {
          try {
            this.showCodeLoading();
            const url = this.baseUrl + path;
            const response = await fetch(url);
            const code = await response.text();

            this.elements.container.innerHTML = "";
            this.renderCodeViewer(path, code);
            this.elements.backBtn.style.display = "inline-block";
          } catch (error) {
            console.error("Error loading file:", error);
            this.showError("Failed to load code. Please try again.");
          }
        }

        renderCodeViewer(path, code) {
          const data = this.problemData.get(path);
          const fileName = path.split("/").pop().replace(".cs", "");

          this.elements.pathTitle.textContent = fileName;
          this.updateBreadcrumb(["Home", "...", fileName]);

          this.elements.codeViewer.innerHTML = `
                    <div class="code-header slide-in">
                        <div>
                            <div class="code-title">${fileName}</div>
                        </div>
                        <div class="code-actions">
                            <button class="action-btn tooltip" onclick="platform.copyCode()" data-tooltip="Copy code">
                                📋 Copy
                            </button>
                            <button class="action-btn tooltip" onclick="platform.downloadCode('${fileName}', \`${code.replace(
            /`/g,
            "\\`"
          )}\`)" data-tooltip="Download file">
                                💾 Download
                            </button>
                            <button class="action-btn tooltip favorite-btn ${
                              this.favorites.has(path) ? "favorited" : ""
                            }" 
                                    onclick="platform.toggleFavorite('${path}')" data-tooltip="Add to favorites">
                                ♥ Favorite
                            </button>
                        </div>
                    </div>
                    <pre class="fade-in"><code class="language-csharp">${this.escapeHtml(
                      code
                    )}</code></pre>
                `;

          // Highlight code
          hljs.highlightAll();
        }

        copyCode() {
          const codeElement = document.querySelector("#codeViewer code");
          if (codeElement) {
            navigator.clipboard
              .writeText(codeElement.textContent)
              .then(() => {
                this.showNotification("Code copied to clipboard!", "success");
              })
              .catch(() => {
                this.showNotification("Failed to copy code", "error");
              });
          }
        }

        downloadCode(fileName, code) {
          const blob = new Blob([code], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `${fileName}.cs`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          this.showNotification("File downloaded!", "success");
        }

        navigateBack() {
          const prev = this.history.pop();
          if (prev) {
            if (Array.isArray(prev.level)) {
              this.currentFilter = prev.filter || "all";
              this.searchQuery = prev.search || "";
              this.elements.searchInput.value = this.searchQuery;
              this.renderResults(prev.level, prev.title);
            } else {
              this.renderLevel(prev.level, prev.title);
            }
          } else {
            this.applyFilters();
          }
        }

        showLoading() {
          this.elements.container.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                `;
        }

        showCodeLoading() {
          this.elements.codeViewer.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                `;
        }

        showNoResults() {
          this.elements.container.innerHTML = `
                    <div class="no-results fade-in">
                        <div class="no-results-icon">🔍</div>
                        <h3>No solutions found</h3>
                        <p>Try adjusting your search or filters</p>
                    </div>
                `;
        }

        showError(message) {
          this.elements.container.innerHTML = `
                    <div class="no-results fade-in">
                        <div class="no-results-icon">⚠️</div>
                        <h3>Error</h3>
                        <p>${message}</p>
                    </div>
                `;
        }

        showNotification(message, type = "info") {
          const notification = document.createElement("div");
          notification.className = `notification notification-${type}`;
          notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${
                      type === "success"
                        ? "var(--success)"
                        : type === "error"
                        ? "var(--error)"
                        : "var(--primary)"
                    };
                    color: white;
                    padding: 1rem 2rem;
                    border-radius: 10px;
                    box-shadow: var(--shadow-lg);
                    z-index: 1000;
                    animation: slideIn 0.3s ease-out;
                `;
          notification.textContent = message;

          document.body.appendChild(notification);

          setTimeout(() => {
            notification.style.animation = "slideOut 0.3s ease-in forwards";
            setTimeout(() => {
              document.body.removeChild(notification);
            }, 300);
          }, 3000);
        }

        escapeHtml(text) {
          return text.replace(
            /[&<>"']/g,
            (m) =>
              ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#039;",
              }[m])
          );
        }
      }

      // Initialize the platform
      const platform = new LeetCodePlatform();

      // Add some CSS animations
      const style = document.createElement("style");
      style.textContent = `
            @keyframes slideOut {
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
            
            .notification {
                animation: slideIn 0.3s ease-out;
            }
        `;
      document.head.appendChild(style);
    </script>
  </body>
</html>
